# Bindings:
# - to see current bindings:
#   tmux list-keys

# Force a reload of the config file
unbind r
bind r source-file ~/.tmux.conf \; display "Reloaded ~/.tmux.conf"

# Set prefix to space.
unbind C-b
set -g prefix C-Space

# No mouse
set -g mouse on

# No delay for escape key press
set -sg escape-time 0

# Start window and pane numbering at 1, (0 is too hard to reach).
set -g base-index 1
set -g pane-base-index 1

# Open new/split panes with the path of the current pane.
unbind c
bind c new-window -c '#{pane_current_path}'

# Terminal emulator window title
set -g set-titles on
set -g set-titles-string "#{pane_title} * #{session_name}:#{window_index}.#{pane_index} * #{window_name}"

# Don't change tmux's own window titles.
set -w -g automatic-rename off

# Don't wrap searches; it's super confusing given tmux's reverse-ordering of
# position info in copy mode.
set -w -g wrap-search off

# Scrollback/history
set-option -g history-limit 4096
bind-key C-k send-keys -R \; clear-history

# Use vi mode
setw -g mode-keys vi
set -g status-keys vi

unbind [
unbind ]
unbind p
unbind-key -T copy-mode-vi v
unbind-key -T copy-mode-vi Space
unbind-key -T copy-mode-vi Enter
bind-key -T copy-mode-vi 'v' send -X begin-selection # Begin selection in copy mode.
bind-key -T copy-mode-vi 'C-v' send -X rectangle-toggle # Begin selection in copy mode.
bind p paste-buffer
bind Escape copy-mode

# Clipper.
bind-key y run-shell "tmux save-buffer - | socat - UNIX-CONNECT:/tmp/.clipper.sock"
bind-key -T copy-mode-vi 'y' send-keys -X copy-pipe-and-cancel "socat - UNIX-CONNECT:/tmp/.clipper.sock"

# More straight forward key bindings for splitting windows
# same as the ones I use on spacemacs
unbind %
unbind '"'
bind / split-window -h -c '#{pane_current_path}'
bind - split-window -v -c '#{pane_current_path}'

bind-key J resize-pane -D 5
bind-key K resize-pane -U 5
bind-key H resize-pane -L 5
bind-key L resize-pane -R 5

# Vim style pane selection
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Cycle to next pane
bind-key -r Tab select-pane -t :.+

# Fast toggle between current and last-used pane
bind ^tab last-pane

unbind z
bind m resize-pane -Z

# Theme
set -g window-status-current-fg cyan
set -g window-status-current-attr bold
set -g pane-border-bg colour235
set -g pane-border-fg colour238
set -g pane-active-border-bg colour236
set -g pane-active-border-fg colour51

# Status bar.
set -g status-bg black
set -g status-fg white
set -g status-left '#(/bin/bash ~/src/github.com/jonmosco/kube-tmux/kube.tmux 250 red cyan) #[fg=green,bold] #[fg=yellow]#{window_index}.#{pane_index} '
set -g status-right '#{pane_current_path} #[fg=colour245] #(date +"%a %b %-d, %-l:%M%p") #(whoami)'
set -g status-interval 60
set -g status-left-length 40
set -g status-right-length 140

# zsh+tmux+osx
if-shell "uname | grep -q Darwin" "set -g default-command 'reattach-to-user-namespace -l zsh'"

# tmux.conf examples, reference
# https://github.com/wincent/wincent/blob/master/roles/dotfiles/files/.tmux.conf
# https://gist.github.com/spicycode/1229612
# https://github.com/axsuul/dotfiles/blob/master/home/.tmux.conf quick pane
# https://github.com/tmuxinator/tmuxinator
# https://gist.github.com/shinzui/866897

set -g default-terminal "xterm-256color"
