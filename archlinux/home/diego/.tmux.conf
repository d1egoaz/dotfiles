# Bindings:
# - to see current bindings:
#   tmux list-keys

# Force a reload of the config file
unbind r
bind r source-file ~/.tmux.conf \; display "Reloaded ~/.tmux.conf"

# Set prefix to space.
unbind C-b
set -g prefix C-Space

# No mouse
set -g mouse off

set-window-option -g monitor-activity on

# No delay for escape key press
set -sg escape-time 0

# Start window and pane numbering at 1, (0 is too hard to reach).
set -g base-index 1
set -g pane-base-index 1

# Open new/split panes with the path of the current pane.
unbind c
bind c new-window -c '#{pane_current_path}'

# Terminal emulator window title
set -g set-titles on
set -g set-titles-string "#{pane_title} * #{session_name}:#{window_index}.#{pane_index} * #{window_name}"

# Don't change tmux's own window titles.
set -w -g automatic-rename on

# Don't wrap searches; it's super confusing given tmux's reverse-ordering of
# position info in copy mode.
set -w -g wrap-search off

# Scrollback/history
set-option -g history-limit 2621440
bind-key C-k send-keys -R \; clear-history

# Use vi mode
setw -g mode-keys vi
set -g status-keys vi

unbind [
unbind ]
unbind p
unbind-key -T copy-mode-vi v
unbind-key -T copy-mode-vi Space
unbind-key -T copy-mode-vi Enter
bind-key -T copy-mode-vi 'v' send -X begin-selection # Begin selection in copy mode.
bind-key -T copy-mode-vi 'C-v' send -X rectangle-toggle # Begin selection in copy mode.
bind p paste-buffer
bind Escape copy-mode

# Clipper.
bind-key y run-shell "tmux save-buffer - | socat - UNIX-CONNECT:$HOME/.local/share/clipper/clipper.sock"
bind-key -T copy-mode-vi 'y' send-keys -X copy-pipe-and-cancel "socat - UNIX-CONNECT:$HOME/.local/share/clipper/clipper.sock"

# More straight forward key bindings for splitting windows
# same as the ones I use on spacemacs
unbind %
unbind '"'
bind / split-window -h -c '#{pane_current_path}'; refresh-client -S
bind - split-window -v -c '#{pane_current_path}'; refresh-client -S

bind-key J resize-pane -D 5
bind-key K resize-pane -U 5
bind-key H resize-pane -L 5
bind-key L resize-pane -R 5

# Vim style pane selection
bind h select-pane -L\; refresh-client -S
bind j select-pane -D\; refresh-client -S
bind k select-pane -U\; refresh-client -S
bind l select-pane -R\; refresh-client -S

# Cycle to next pane
bind-key -r Tab select-pane -t :.+

# Fast toggle between current and last-used pane
bind ^tab last-pane

unbind z
bind m resize-pane -Z

# Status bar.
set -g status-bg black
set -g status-fg white
set -g status-left '#(ktmux colour148 yellow)'
set -g status-right '|#[fg=#b7cfff]#(date +"%%a %%b %%d")|PT-8 #(TZ="America/Vancouver" date +"%%-l:%%M%%p")#[nobold,fg=colour4]|ET-5 #(TZ="America/Toronto" date +"%%-l:%%M%%p")|#(date -u +"%%Y-%%m-%%dT%%H:%%M:%%SZ")|'
set -g status-interval 60
set -g status-left-length 70
set -g status-right-length 100

# zsh+tmux+osx
if-shell "uname | grep -q Darwin" "set -g default-command 'reattach-to-user-namespace -l zsh'"

set -g default-terminal "xterm-256color"

# Colour scheme from: https://github.com/mattdavis90/base16-tmux/blob/master/colors/base16-onedark.conf
# NOTE: remember to keep "My custom theme modifications" at the end
# COLOUR (base16)

# default statusbar colors
set-option -g status-style "fg=#b4b7b4,bg=#282a2e"

# default window title colors
set-window-option -g window-status-style "fg=#b4b7b4,bg=default"

# active window title colors
set-window-option -g window-status-current-style "fg=#f0c674,bg=default"

# pane border
set-option -g pane-border-style "fg=#282a2e"
set-option -g pane-active-border-style "fg=#373b41"

# message text
set-option -g message-style "fg=#c5c8c6,bg=#282a2e"

# pane number display
set-option -g display-panes-active-colour "#b5bd68"
set-option -g display-panes-colour "#f0c674"

# clock
set-window-option -g clock-mode-colour "#b5bd68"

# copy mode highligh
set-window-option -g mode-style "fg=#b4b7b4,bg=#373b41"

# bell
set-window-option -g window-status-bell-style "fg=#282a2e,bg=#cc6666"

# My custom theme modifications
set -g pane-active-border-style "fg=cyan"
